<!-- JQuery CDN -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.2/jquery.validate.min.js" integrity="sha512-UdIMMlVx0HEynClOIFSyOrPggomfhBKJE28LKl8yR3ghkgugPnG6iLfRfHwushZl1MOPSY6TsuBDGPK2X4zYKg==" crossorigin="anonymous"></script>

<!-- Bootstrap CDN -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.6.0/js/bootstrap.bundle.min.js" integrity="sha512-wV7Yj1alIZDqZFCUQJy85VN+qvEIly93fIQAN7iqDFCPEucLCeNFz4r35FCo9s6WrpdDQPi80xbljXB8Bjtvcg==" crossorigin="anonymous"></script>

<script>
$(document).ready(function(){
  $('[data-toggle="tooltip"]').tooltip();
});
</script>

<h1>The Actual Form!</h1>

<p>
Hello {{username}}
</p>
<p>
<a href="/logout">Logout</a>
</p>

  <h2>CVE Request</h2>

<div class="container">
  <form action="/cveform/formsubmit" name="requestCVE" method="post">
  <div class="row">
    <div class="col">
      <div class="form-group">
        <label for="vendorName">Vendor Name</label>
        <input type="text" class="form-control" data-toggle="tooltip" title="The name of the vendor or project who release the software affected" name="vendorName" id="vendorName" placeholder="Vendor"/>
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col">
      <div class="form-group">
        <label for="productName">Product Name</label>
        <input type="text" class="form-control" data-toggle="tooltip" title="The name of the product that contains the vulnerability. This could be the same as the vendor" name="productName" id="productName" placeholder="Product"/>
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col">
      <div class="form-group">
        <label for="productVersion">Affected Version(s)</label>
        <input type="text" class="form-control" data-toggle="tooltip" title="The vulnerable versions. This is freetext. Exampes: '1.0' 'before 2.7' '1.0.2 to 1.1.8'" name="productVersion" id="productVersion" placeholder="Version"/>
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col">
      <div class="form-group">
        <label for="vulnType">Vulnerability Type</label>
        <input type="text" class="form-control" data-toggle="tooltip" title="Examples include 'Cross Site Scripting (XSS)' 'buffer overflow' 'information disclosure' - See also CWE" name="vulnType" id="vulnType" placeholder="Vulnerability Type"/>
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col">
      <div class="form-group">
        <label for="affectedComponent">Affected Component</label>
        <input type="text" class="form-control" data-toggle="tooltip" title="The part of the larger software affected. This could be the same as the product name" name="affectedComponent" id="affectedComponent" placeholder="Affected Component"/>
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col">
      <div class="form-group">
        <label for="attackVector">Attack Vector</label>
        <input type="text" class="form-control" data-toggle="tooltip" title="How we could attack this. Examples: local access, network access, crafted email, authenticated access" name="attackVector" id="attackVector" placeholder="Attack Vector"/>
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col">
      <div class="form-group">
        <label for="impact">Impact of Exploitation</label>
        <select class="form-control" data-toggle="tooltip" data-toggle="tooltip" title="Just pick one, it'll be OK" title="Test tooltip text" id="impact" name="impact">
          <option>DoS</option>
          <option>Impact 2</option>
          <option>Impact 5</option>
          <option>Impact 1298</option>
          <option>Unknown</option>
        </select>
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col">
      <div class="form-group">
        <label for="credit">Discoverer/Credit</label>
        <input type="text" class="form-control" data-toggle="tooltip" title="Who found this? Leave it blank if you don't know" name="credit" id="credit" placeholder="Credit"/>
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col">
      <div class="form-group">
        <label for="references">References</label>
        <input type="text" class="form-control" data-toggle="tooltip" title="A URL pointed at some important details" name="references" id="references" placeholder="References"/>
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col">
      <div class="form-group">
        <label for="notes">Notes</label>
        <textarea class="form-control" data-toggle="tooltip" title="Any extra details that would be useful to know, can be left blank" id="notes" name="notes" placeholder="Additional notes ..."></textarea>
      </div>
    </div>
  </div>

    <button class="btn btn-primary" type="submit">Get a CVE ID</button>
</div>

  </form>
</div>

<script>
// Wait for the DOM to be ready
$(function() {


  $("form[name='requestCVE']").validate({
    rules: {
      vendorName: "required",
      productName: "required",
      productVersion: "required",
      vulnType: "required",
      affectedComponent: "required",
      attackVector: "required",
      impact: "required",
      references: "required",
    },
    messages: {
      vendorName: "Please enter a vendor name",
      productName: "Please enter a product name",
      productVersion: "Please enter a product version",
      vulnType: "Please enter a vulnerability type",
      affectedComponent: "Please enter a component name",
      attackVector: "Please enter a vector",
      impact: "Please choose an impact",
      references: "Please provide at least one reference",
    },
    // Make sure the form is submitted to the destination defined
    // in the "action" attribute of the form when valid
    submitHandler: function(form) {
      form.submit();
    }
  });
});

</script>
